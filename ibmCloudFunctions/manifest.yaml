packages:
  product-consumers:
    actions:
      consume-catalog-message:
        location: ./consumeCatalogMessage/dist/bundle.js
        runtime: nodejs:10
        limits:
          memorySize: 128
        inputs:
          mongoUri: $MONGO_URI
          mongoCertificateBase64: $MONGO_CERTIFICATE_BASE64
          dbName: $DB_NAME
          collectionName: $STYLES_COLLECTION_NAME
          pricesCollectionName: $PRICES_COLLECTION_NAME
          topicName: styles-connect-jdbc-CATALOG
      update-sale-price:
        location: ./updateSalePrice/dist/bundle.js
        runtime: nodejs:10
        limits:
          memorySize: 128
        inputs:
          mongoUri: $MONGO_URI
          mongoCertificateBase64: $MONGO_CERTIFICATE_BASE64
          dbName: $DB_NAME
          collectionName: $PRICES_COLLECTION_NAME
          topicName: prices-connect-jdbc
      consume-stores-message:
        location: ./consumeStoresMessage/dist/bundle.js
        runtime: nodejs:10
        limits:
          memorySize: 128
        inputs:
          mongoUri: $MONGO_URI
          mongoCertificateBase64: $MONGO_CERTIFICATE_BASE64
          dbName: $DB_NAME
          collectionName: $STORES_COLLECTION_NAME
          topicName: stores-connect-jdbc-SITES
      consume-sku-inventory-message:
        location: ./consumeSkuInventoryMessage/dist/bundle.js
        runtime: nodejs:10
        limits:
          memorySize: 128
        inputs:
          mongoUri: $MONGO_URI
          mongoCertificateBase64: $MONGO_CERTIFICATE_BASE64
          dbName: $DB_NAME
          collectionName: $INVENTORY_COLLECTION_NAME
          topicName: inventory-connect-jdbc-SKUINVENTORY
      update-algolia-style:
        location: ./updateAlgoliaStyle/dist/bundle.js
        runtime: nodejs:10
        limits:
          memorySize: 128
        inputs:
          mongoUri: $MONGO_URI
          mongoCertificateBase64: $MONGO_CERTIFICATE_BASE64
          dbName: $DB_NAME
          collectionName: $STYLES_COLLECTION_NAME
          topicName: styles-connect-jdbc-CATALOG
          algoliaApiKey: $ALGOLIA_API_KEY
          algoliaIndexName: $ALGOLIA_INDEX_NAME
          algoliaAppId: $ALGOLIA_APP_ID
          productApiClientId: $PRODUCT_API_CLIENT_ID
          productApiHost: $PRODUCT_API_HOST
      update-algolia-price:
        location: ./updateAlgoliaPrice/dist/bundle.js
        runtime: nodejs:10
        limits:
          memorySize: 128
        inputs:
          topicName: prices-connect-jdbc
          algoliaApiKey: $ALGOLIA_API_KEY
          algoliaIndexName: $ALGOLIA_INDEX_NAME
          algoliaAppId: $ALGOLIA_APP_ID
      update-algolia-inventory:
        location: ./updateAlgoliaInventory/dist/bundle.js
        runtime: nodejs:10
        limits:
          memorySize: 128
        inputs:
          topicName: inventory-connect-jdbc-SKUINVENTORY
          algoliaApiKey: $ALGOLIA_API_KEY
          algoliaIndexName: $ALGOLIA_INDEX_NAME
          algoliaAppId: $ALGOLIA_APP_ID
      consume-medias-message:
        location: ./consumeMediasMessage/dist/bundle.js
        runtime: nodejs:10
        limits:
          memorySize: 128
        inputs:
          mongoUri: $MONGO_URI
          mongoCertificateBase64: $MONGO_CERTIFICATE_BASE64
          dbName: $DB_NAME
          collectionName: $MEDIAS_COLLECTION_NAME
          topicName: medias-connect-jdbc
      consume-media-containers-message:
        location: ./consumeMediaContainersMessage/dist/bundle.js
        runtime: nodejs:10
        limits:
          memorySize: 128
        inputs:
          mongoUri: $MONGO_URI
          mongoCertificateBase64: $MONGO_CERTIFICATE_BASE64
          dbName: $DB_NAME
          collectionName: $MEDIA_CONTAINERS_COLLECTION_NAME
          topicName: media-containers-connect-jdbc
    triggers:
      catalog-trigger:
        feed: /${ORG}_${SPACE}/${FEED_BASE}/messageHubFeed
        inputs:
          isJSONData: true
          topic: styles-connect-jdbc-CATALOG
      medias-trigger:
        feed: /${ORG}_${SPACE}/${FEED_BASE}/messageHubFeed
        inputs:
          isJSONData: true
          topic: medias-connect-jdbc
      stores-trigger:
        feed: /${ORG}_${SPACE}/${FEED_BASE}/messageHubFeed
        inputs:
          isJSONData: true
          topic: stores-connect-jdbc-SITES
      media-containers-trigger:
        feed: /${ORG}_${SPACE}/${FEED_BASE}/messageHubFeed
        inputs:
          isJSONData: true
          topic: media-containers-connect-jdbc
      sale-price-trigger:
        feed: /${ORG}_${SPACE}/${FEED_BASE}/messageHubFeed
        inputs:
          isJSONData: true
          topic: prices-connect-jdbc
      sku-inventory-trigger:
        feed: /${ORG}_${SPACE}/${FEED_BASE}/messageHubFeed
        inputs:
          isJSONData: true
          topic: inventory-connect-jdbc-SKUINVENTORY
    rules:
      catalog-rule:
        action: /${ORG}_${SPACE}/product-consumers/consume-catalog-message
        trigger: catalog-trigger
      medias-rule:
        action: /${ORG}_${SPACE}/product-consumers/consume-medias-message
        trigger: medias-trigger
      stores-rule:
        action: /${ORG}_${SPACE}/product-consumers/consume-stores-message
        trigger: stores-trigger
      media-containers-rule:
        action: /${ORG}_${SPACE}/product-consumers/consume-media-containers-message
        trigger: media-containers-trigger
      sale-price-rule:
        action: /${ORG}_${SPACE}/product-consumers/update-sale-price
        trigger: /${ORG}_${SPACE}/sale-price-trigger
      #algolia-catalog-rule:
      #  action: /${ORG}_${SPACE}/product-consumers/update-algolia-style
      #  trigger: /${ORG}_${SPACE}/catalog-trigger
      #algolia-price-rule:
       # action: /${ORG}_${SPACE}/product-consumers/update-algolia-price
       # trigger: /${ORG}_${SPACE}/sale-price-trigger
      sku-inventory-rule:
        action: /${ORG}_${SPACE}/product-consumers/consume-sku-inventory-message
        trigger: /${ORG}_${SPACE}/sku-inventory-trigger
      #algolia-inventory-rule:
       # action: /${ORG}_${SPACE}/product-consumers/update-algolia-inventory
       # trigger: /${ORG}_${SPACE}/sku-inventory-trigger
